#include <Eigen/Core>

Eigen::Vector3d reflect(const Eigen::Vector3d &in, const Eigen::Vector3d &n)
{
  ////////////////////////////////////////////////////////////////////////////
  auto n_normalized = n.normalized();
  return in - 2 * (in.dot(n_normalized)) * n_normalized;
  ////////////////////////////////////////////////////////////////////////////
}
