# Title: The Wind Dragon
## IMPORTANT
### The piece.ppm is the actual final piece of work. <br>
### The piece.png is there for viewing as the broswer does not natively support viewing a ppm file!
## Personal Information:
#### Full Name:       **Morris Sun** <br>
#### UtorID:          **sunxia72**   <br>
#### student number:  **1006701767** <br>
#### Assignments:     **A3 and A4**  <br>
## Instructions:
### HEADS-UP: The project has been tested only on Ubuntu 24.04 LTS WSL. It is not guaranteed to work on other linux distributions!
##### run the following commands in the terminal
##### Install essential tools
``` bash
    sudo apt update
    sudo apt install build-essential
```
##### Install Cmake build tool
``` bash
    sudo apt install cmake
```

##### Install Version Control tool
```bash
    sudo apt install git
```

##### Now change directory to where you want the project to be and run
```bash
    git clone --recurse-submodules https://github.com/MorrisXDS/CSC-317-Showcase.git
    cd CSC-317-Showcase
```

##### build the project
```bash
    rm -rf build-release && mkdir build-release && cd build-release && cmake -DCMAKE_BUILD_TYPE=Release .. && make -j$(nproc) && cd ..
    
    rm -rf build-debug && mkdir build-debug && cd build-debug && cmake -DCMAKE_BUILD_TYPE=Debug .. && make -j$(nproc) && cd ..
```

##### To run the program in release mode 
```bash
    cd build-release
    ./raytracing ../data/wind-dragon.json
    cd ..
```

##### To run the program in debug mode 
```bash
    cd build-debug
    ./raytracing ../data/wind-dragon.json
    cd ..
```

##### To run the program on all input
```bash
    cd build-release
    chmod +x ../multi-run.sh
    ../multi-run.sh
    cd ..
```

##### To view produced files in release mode
```bash
    cd build-release
    ls *.ppm
    cd ..
```
##### To view produced files in debug mode
```bash
    cd build-debug
    ls *.ppm
    cd ..
```
#### The ppm file generated by external stl is wind-dragon.rgb.ppm
## Description:
##### 1. A customized json file to display the output of assignment 3 on the wind-dragon.stl
##### 2. The current code runs significantly faster than the base assignment 3 we started with Time taken to produce a complex ppm from a complext stl has been reduced from several hours to days has been reduced to several minutes to hours.
##### 3. It combines the blinn-phong model and reflection from assignment 3. In the meantime, it uses AABB tree to find ray hits. This improves ray hit lookup from O(n) to O(log (n))
##### 4. The read_json is modified to load soups as triangles.
##### 5. Triangles, planes and spheres are also changed to adapt the interface from Object in Assignment 4
##### 6. An external complex stl has been used to test the program. It is wind-dragon.stl
##### 7. used imagemagick to render final ppm file to a png file
#####  8. used openmp parallelization in compiler flags to speed up rendering in main.cpp

## Acknowledgements: 
##### 1. [CF Wind Dragon](https://www.thingiverse.com/thing:7196967)
##### 2. Assignment 3
##### 3. Assignment 4
##### 4. Eigen library submodule
##### 5. nlohmann json used in Assignment 3
##### 6. imagemagick 

## Compilation Verification:
If you run in project root
```bash 
    rm -rf build-release && mkdir build-release && cd build-release && cmake -DCMAKE_BUILD_TYPE=Release .. && make -j$(nproc) && cd ..
    rm -rf build-debug && mkdir build-debug && cd build-debug && cmake -DCMAKE_BUILD_TYPE=Debug .. && make -j$(nproc) && cd ..
```
you will get the following output
```bash
-- The CXX compiler identification is GNU 13.3.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- raytracing includes /home/morris/CSC-317-Showcase/eigen
-- Building core library from source
-- core includes /home/morris/CSC-317-Showcase/eigen
-- Configuring done (1.0s)
-- Generating done (0.0s)
-- Build files have been written to: /home/morris/CSC-317-Showcase/build-release
[  8%] Building CXX object CMakeFiles/core.dir/Code/src/AABBTree_ray_intersect.cpp.o
[  8%] Building CXX object CMakeFiles/core.dir/Code/src/DirectionalLight.cpp.o
[  8%] Building CXX object CMakeFiles/core.dir/Code/src/AABBTree.cpp.o
[ 10%] Building CXX object CMakeFiles/core.dir/Code/src/Plane.cpp.o
[ 13%] Building CXX object CMakeFiles/core.dir/Code/src/PointLight.cpp.o
[ 16%] Building CXX object CMakeFiles/core.dir/Code/src/blinn_phong_shading.cpp.o
[ 18%] Building CXX object CMakeFiles/core.dir/Code/src/Triangle.cpp.o
[ 21%] Building CXX object CMakeFiles/core.dir/Code/src/box_box_intersect.cpp.o
[ 24%] Building CXX object CMakeFiles/core.dir/Code/src/ray_intersect_box.cpp.o
[ 29%] Building CXX object CMakeFiles/core.dir/Code/src/insert_box_into_box.cpp.o
[ 29%] Building CXX object CMakeFiles/core.dir/Code/src/reflect.cpp.o
[ 32%] Building CXX object CMakeFiles/core.dir/Code/src/insert_triangle_into_box.cpp.o
[ 35%] Building CXX object CMakeFiles/core.dir/Code/src/triangle_triangle_intersection.cpp.o
[ 37%] Building CXX object CMakeFiles/core.dir/Code/src/raycolor.cpp.o
[ 40%] Building CXX object CMakeFiles/core.dir/Code/src/ray_intersect_triangle.cpp.o
[ 43%] Building CXX object CMakeFiles/core.dir/Code/src/viewing_ray.cpp.o
[ 45%] Building CXX object CMakeFiles/core.dir/Code/src/write_ppm.cpp.o
[ 48%] Linking CXX static library libcore.a
[ 48%] Built target core
[ 54%] Building CXX object CMakeFiles/raytracing.dir/Code/src/AABBTree_ray_intersect.cpp.o
[ 56%] Building CXX object CMakeFiles/raytracing.dir/Code/src/AABBTree.cpp.o
[ 56%] Building CXX object CMakeFiles/raytracing.dir/Code/src/DirectionalLight.cpp.o
[ 59%] Building CXX object CMakeFiles/raytracing.dir/Code/src/Plane.cpp.o
[ 62%] Building CXX object CMakeFiles/raytracing.dir/Code/src/insert_box_into_box.cpp.o
[ 72%] Building CXX object CMakeFiles/raytracing.dir/Code/src/blinn_phong_shading.cpp.o
[ 72%] Building CXX object CMakeFiles/raytracing.dir/Code/src/PointLight.cpp.o
[ 72%] Building CXX object CMakeFiles/raytracing.dir/Code/src/box_box_intersect.cpp.o
[ 72%] Building CXX object CMakeFiles/raytracing.dir/Code/src/insert_triangle_into_box.cpp.o
[ 75%] Building CXX object CMakeFiles/raytracing.dir/Code/src/ray_intersect_triangle.cpp.o
[ 78%] Building CXX object CMakeFiles/raytracing.dir/Code/src/ray_intersect_box.cpp.o
[ 81%] Building CXX object CMakeFiles/raytracing.dir/Code/src/reflect.cpp.o
[ 83%] Building CXX object CMakeFiles/raytracing.dir/Code/src/Triangle.cpp.o
[ 86%] Building CXX object CMakeFiles/raytracing.dir/Code/src/triangle_triangle_intersection.cpp.o
[ 89%] Building CXX object CMakeFiles/raytracing.dir/Code/src/raycolor.cpp.o
[ 91%] Building CXX object CMakeFiles/raytracing.dir/Code/src/viewing_ray.cpp.o
[ 94%] Building CXX object CMakeFiles/raytracing.dir/Code/src/write_ppm.cpp.o
[ 97%] Building CXX object CMakeFiles/raytracing.dir/Code/main.cpp.o
[100%] Linking CXX executable raytracing
lto-wrapper: warning: using serial compilation of 3 LTRANS jobs
lto-wrapper: note: see the ‘-flto’ option documentation for more information
[100%] Built target raytracing
-- The CXX compiler identification is GNU 13.3.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- raytracing includes /home/morris/CSC-317-Showcase/eigen
-- Building core library from source
-- core includes /home/morris/CSC-317-Showcase/eigen
-- Configuring done (1.0s)
-- Generating done (0.0s)
-- Build files have been written to: /home/morris/CSC-317-Showcase/build-debug
[  5%] Building CXX object CMakeFiles/core.dir/Code/src/AABBTree_ray_intersect.cpp.o
[  5%] Building CXX object CMakeFiles/core.dir/Code/src/AABBTree.cpp.o
[  8%] Building CXX object CMakeFiles/core.dir/Code/src/Plane.cpp.o
[ 10%] Building CXX object CMakeFiles/core.dir/Code/src/DirectionalLight.cpp.o
[ 13%] Building CXX object CMakeFiles/core.dir/Code/src/PointLight.cpp.o
[ 16%] Building CXX object CMakeFiles/core.dir/Code/src/Triangle.cpp.o
[ 21%] Building CXX object CMakeFiles/core.dir/Code/src/insert_triangle_into_box.cpp.o
[ 21%] Building CXX object CMakeFiles/core.dir/Code/src/blinn_phong_shading.cpp.o
[ 24%] Building CXX object CMakeFiles/core.dir/Code/src/box_box_intersect.cpp.o
[ 29%] Building CXX object CMakeFiles/core.dir/Code/src/ray_intersect_triangle.cpp.o
[ 29%] Building CXX object CMakeFiles/core.dir/Code/src/ray_intersect_box.cpp.o
[ 32%] Building CXX object CMakeFiles/core.dir/Code/src/insert_box_into_box.cpp.o
[ 35%] Building CXX object CMakeFiles/core.dir/Code/src/viewing_ray.cpp.o
[ 40%] Building CXX object CMakeFiles/core.dir/Code/src/triangle_triangle_intersection.cpp.o
[ 40%] Building CXX object CMakeFiles/core.dir/Code/src/raycolor.cpp.o
[ 43%] Building CXX object CMakeFiles/core.dir/Code/src/reflect.cpp.o
[ 45%] Building CXX object CMakeFiles/core.dir/Code/src/write_ppm.cpp.o
[ 48%] Linking CXX static library libcore.a
[ 48%] Built target core
[ 56%] Building CXX object CMakeFiles/raytracing.dir/Code/src/AABBTree.cpp.o
[ 56%] Building CXX object CMakeFiles/raytracing.dir/Code/src/Plane.cpp.o
[ 56%] Building CXX object CMakeFiles/raytracing.dir/Code/src/AABBTree_ray_intersect.cpp.o
[ 59%] Building CXX object CMakeFiles/raytracing.dir/Code/src/PointLight.cpp.o
[ 62%] Building CXX object CMakeFiles/raytracing.dir/Code/src/Triangle.cpp.o
[ 64%] Building CXX object CMakeFiles/raytracing.dir/Code/src/DirectionalLight.cpp.o
[ 67%] Building CXX object CMakeFiles/raytracing.dir/Code/src/blinn_phong_shading.cpp.o
[ 70%] Building CXX object CMakeFiles/raytracing.dir/Code/src/box_box_intersect.cpp.o
[ 72%] Building CXX object CMakeFiles/raytracing.dir/Code/src/ray_intersect_box.cpp.o
[ 75%] Building CXX object CMakeFiles/raytracing.dir/Code/src/insert_box_into_box.cpp.o
[ 78%] Building CXX object CMakeFiles/raytracing.dir/Code/src/insert_triangle_into_box.cpp.o
[ 81%] Building CXX object CMakeFiles/raytracing.dir/Code/src/ray_intersect_triangle.cpp.o
[ 83%] Building CXX object CMakeFiles/raytracing.dir/Code/src/raycolor.cpp.o
[ 86%] Building CXX object CMakeFiles/raytracing.dir/Code/src/viewing_ray.cpp.o
[ 89%] Building CXX object CMakeFiles/raytracing.dir/Code/src/reflect.cpp.o
[ 91%] Building CXX object CMakeFiles/raytracing.dir/Code/src/triangle_triangle_intersection.cpp.o
[ 97%] Building CXX object CMakeFiles/raytracing.dir/Code/main.cpp.o
[ 97%] Building CXX object CMakeFiles/raytracing.dir/Code/src/write_ppm.cpp.o
[100%] Linking CXX executable raytracing
lto-wrapper: warning: using serial compilation of 3 LTRANS jobs
lto-wrapper: note: see the ‘-flto’ option documentation for more information
[100%] Built target raytracing
```